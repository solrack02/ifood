name: Build and Deploy Expo Project

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '14.x'

    - name: Install dependencies
      run: npm install

    - name: Install Expo CLI
      run: npm install -g expo-cli

    - name: Install execa
      run: npm install execa

    - name: Create Node.js script
      run: |
        echo 'const execa = require("execa");

        (async () => {
          try {
            const { stdout, stderr } = await execa("npx", ["eas-cli", "init"], {
              input: "y\n",
            });
            console.log(stdout);
            console.error(stderr);
          } catch (error) {
            console.error("Error:", error);
          }
        })();' > eas-init.js
        
    - name: Read eas-init
      run: |
        echo "READ FILE eas-init"
        cat eas-init.js
